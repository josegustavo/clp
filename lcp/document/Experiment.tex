\section{Estudio experimental}

Este capítulo describe el diseño y los resultados de un experimento computacional realizado para evaluar el rendimiento de los algoritmos presentados en el capítulo anterior. El objetivo principal es comparar la eficacia de los algoritmos genéticos con y sin las mejoras propuestas, en términos de calidad de las soluciones y tiempo de ejecución. Para ello, se generaron instancias de prueba aleatorias. Los resultados se analizan y discuten en el contexto del problema de llenado de contenedores.

\subsection{Generación de datos de prueba}

En la literatura, se han propuesto diversos conjuntos de instancias de prueba para evaluar algoritmos de llenado de contenedores. Por ejemplo, \textcite{BISCHOFF1995377} establecieron un método de generación de instancias que se ha utilizado ampliamente en estudios posteriores. Sin embargo, debido a las restricciones del llenado manual, las instancias públicas no son adecuadas para experimentos computacionales. Esto se debe a que, al usar el procedimiento manual descrito en la sección \ref{sec:problem}, las soluciones son menos óptimas en comparación con los algoritmos que no consideran estas restricciones. Por tanto, se decidió generar instancias aleatorias siguiendo un enfoque más realista.

Las siguientes restricciones se consideraron para generar las instancias de prueba:

\begin{itemize}
    \item Las unidades de medida son milímetros, redondeadas al entero más cercano.
    \item El contenedor tiene dimensiones interiores fijas: $L \times W \times H = 12010 \times 2330 \times 2380$ mm.
    \item Cada instancia incluye un número fijo de tipos de cajas: 5, 10, 20 y 30, denominadas 5T, 10T, 20T y 30T, respectivamente.
    \item Las cajas de tipo 5T están contenidas en las de tipo 10T, las de 10T en las de 20T y las de 20T en las de 30T.
    \item Las dimensiones de las cajas se generan aleatoriamente siguiendo una distribución uniforme en el rango $[250, 750]$ mm.
    \item Los valores de las cajas se generan aleatoriamente siguiendo una distribución uniforme en el rango $[1, 100]$, dependiendo del tamaño.
\end{itemize}

Para aumentar la diversidad, se asegura que las dimensiones de las cajas no se repitan dentro de cada instancia. El Algoritmo \ref{alg:evitar_repetir} detalla el procedimiento para evitar la repetición de dimensiones.

\begin{algorithm}[H]
    \caption{Evitar repetir dimensiones}
    \label{alg:evitar_repetir}
    \begin{algorithmic}[1]
        \Require $|T|$, cantidad de cajas a generar.
        \Require $RangoDimensiones$, rango de dimensiones.
        \Ensure $D$, lista de dimensiones.
        \State $D \gets \emptyset$
        \For{$i \gets 1$ \textbf{to} $|T|$}
        \State $d \gets \text{Aleatorio}(RangoDimensiones)$
        \While{$d \in D$}
        \State $d \gets \text{Aleatorio}(RangoDimensiones)$
        \EndWhile
        \State $D \gets D \cup d$
        \EndFor
        \State \textbf{return} $D$
    \end{algorithmic}
\end{algorithm}

En el Algoritmo \ref{alg:evitar_repetir}, $|T|$ es la cantidad de cajas a generar. En la línea 1, se inicializa la lista $D$ de dimensiones. En las líneas 2 a 8, se itera sobre la cantidad de cajas a generar. En la línea 3, se genera una dimensión aleatoria y en la línea 4, se verifica si la dimensión ya existe en la lista $D$. Si es así, se vuelve a generar una dimensión aleatoria (línea 5) hasta que se obtenga una dimensión única. Finalmente, en la línea 9, se retorna la lista $D$ con las dimensiones generadas.

Para determinar la cantidad máxima de cajas de cada tipo que se puede almacenar en un contenedor, se sigue el siguiente enfoque:

1. Dividir el volumen total del contenedor por el número de tipos de cajas especificados. Por ejemplo, cinco tipos de cajas resultan en dividir el contenedor en cinco partes iguales ("5T").
2. Calcular cuántas cajas de cada tipo caben exactamente en la fracción del volumen asignada a ese tipo.
3. Añadir un porcentaje aleatorio de cajas adicionales a cada tipo para aumentar el desafío y realismo.

Este procedimiento se detalla en el Algoritmo \ref{alg:generate}.

\begin{algorithm}[H]
    \caption{Generación de cantidades de cajas}
    \label{alg:generate}
    \begin{algorithmic}[1]
        \Require $V_{\text{total}}$, volumen total del contenedor; $T$, tipos de cajas.
        \Ensure $Q$, lista de cantidades por tipo.
        \State $Q \gets \emptyset$
        \State $v_{\text{fraccion}} \gets V_{\text{total}} / |T|$ \Comment{Dividir el volumen total en partes iguales}
        \For{$t_i \in T$}
        \State $v_i \gets w_i \times l_i \times h_i$ \Comment{Volumen de un tipo $t_i$}
        \State $q_i \gets \lceil v_{\text{fraccion}} / v_i \rceil$
        \State $q_i^{\text{ajustado}} \gets q_i + \text{Aleatorio}(\% \text{adicional})$ \Comment{Añadir un porcentaje aleatorio}
        \State $Q \gets Q \cup q_i^{\text{ajustado}}$
        \EndFor
        \State \textbf{return} $Q$
    \end{algorithmic}
\end{algorithm}

En el Algoritmo \ref{alg:generate}, $V_{\text{total}}$ es el volumen total del contenedor, y $T$ es el conjunto de tipos de cajas. Primero, se inicializa la lista $Q$ de cantidades por tipo (línea 1). Luego, se calcula la fracción del volumen total asignada a cada tipo de caja (línea 2). En las líneas 3 a 8, se calcula el volumen de cada tipo de caja, la cantidad aproximada de cajas que caben en la fracción del volumen asignada y se ajusta esta cantidad añadiendo un porcentaje aleatorio. Finalmente, se retorna la lista $Q$ con las cantidades ajustadas por tipo (línea 9).

El procedimiento completo para generar las instancias de prueba es:

\begin{enumerate}
    \item Generar un conjunto de dimensiones únicas de cajas para cada tipo de caja según el Algoritmo \ref{alg:evitar_repetir}.
    \item Asignar un valor aleatorio a cada caja.
    \item Generar un conjunto de cantidades de cajas para cada tipo de caja, según el Algoritmo \ref{alg:generate}.
\end{enumerate}

Este procedimiento se resume en el Algoritmo \ref{alg:generate_instances}.

\begin{algorithm}[H]
    \caption{Generación de instancias de prueba}
    \label{alg:generate_instances}
    \begin{algorithmic}[1]
        \Require $V_{\text{total}}$, volumen total del contenedor; $C$, cantidad de problemas por tipo; $T$, tipos de cajas.
        \Ensure $P$, lista de instancias de problemas.
        \State $P \gets \emptyset$
        \For{$t_i \in T$}
        \For{$c \gets 1$ \textbf{to} $C$}
        \State $D \gets \text{EvitarRepetirDimensiones}(|T|, RangoDimensiones)$
        \State $V \gets \text{Aleatorio}(|T|, RangoValores)$
        \State $Q \gets \text{GenerarCantidades}(V_{\text{total}}, T)$
        \State $P \gets P \cup (D, V, Q)$
        \EndFor
        \EndFor
        \State \textbf{return} $P$
    \end{algorithmic}
\end{algorithm}

En el Algoritmo \ref{alg:generate_instances}, $V_{\text{total}}$ es el volumen total del contenedor, $C$ es la cantidad de problemas por tipo de caja, y $T$ es el conjunto de tipos de cajas. Primero, se inicializa la lista vacía $P$ de instancias de problemas (línea 1). Luego, se itera sobre la cantidad de tipos de cajas y la cantidad de problemas por tipo de caja. Para cada iteración, se genera un conjunto de dimensiones únicas de cajas, se asignan valores aleatorios y se genera un conjunto de cantidades de cajas para cada tipo de caja. Finalmente, se retorna la lista $P$ con las instancias de problemas generadas (línea 9). Por ejemplo, si hay 4 tipos de cajas (5T, 10T, 20T, 30T) y se desean generar 10 problemas por tipo, se obtendrán 40 instancias de problemas en total.

\subsection{Diseño del experimento}

Para evaluar el rendimiento de los algoritmos genéticos propuestos, se diseñó un experimento computacional que compara los resultados obtenidos con y sin las mejoras propuestas. Se considera una versión sin mejora llamada M0 y cuatro mejoras denominadas M1, M2, M3 y M4, descritas a continuación:

\begin{itemize}
    \item M0: Versión sin mejoras del algoritmo genético.
    \item M1: Mejora de \textit{llenado adicional inmediato}, completando espacios restantes durante el proceso de llenado (Algoritmo \ref{alg:dblf_adaptado_mejoras_m1}).
    \item M2: Mejora de \textit{llenado adicional al final}, completando los espacios restantes al final del proceso de llenado en toda la población (Algoritmo \ref{alg:dblf_adaptado_mejoras_m2}).
    \item M3: Extensión de M2, aplicada a la mitad superior de los individuos según su desempeño.
    \item M4: Mejora de M2, aplicada exclusivamente al mejor individuo de la población.
\end{itemize}

Los algoritmos se implementaron en Python v3.10 y están disponibles en un repositorio de GitHub\footnote{\url{https://github.com/josegustavo/lcp}}.

El experimento se ejecutó en un equipo con un procesador Apple M1 de 8 núcleos (4 núcleos de eficiencia y 4 de rendimiento) y 8 GB de RAM. Para optimizar el uso de los recursos, se paralelizó la ejecución de los algoritmos genéticos para utilizar los 4 núcleos de rendimiento, y se empleó la librería Pypy como intérprete de Python.

Se crearon 25 instancias para cada tipo de caja (5T, 10T, 20T y 30T), sumando un total de 100 instancias de prueba. Cada instancia se ejecutó con las mejoras propuestas M0, M1, M2, M3 y M4 para comparar los resultados.

Cada algoritmo genético se configuró con una población inicial de 100 individuos y un tiempo de ejecución límite de 5 minutos, asegurando condiciones uniformes para la evaluación comparativa. La probabilidad de cruce ($P_{CROSS}$) se estableció en 0.05 y la probabilidad de mutación ($P_{MUT}$) en 0.01. Estos valores fueron seleccionados después de experimentaciones previas que demostraron su eficacia al promover un equilibrio adecuado entre exploración y explotación durante el proceso evolutivo.

Los resultados fueron almacenados en archivos CSV para su posterior análisis. Se evaluaron dos métricas principales: el valor aportado por las soluciones obtenidas y el tiempo de ejecución. También se inspeccionaron aleatoriamente algunas soluciones generadas para verificar su validez y coherencia con las restricciones del problema. Se utilizó la librería Matplotlib para visualizar los resultados y verificar visualmente la calidad de las soluciones obtenidas. Por ejemplo en la Figura \ref{fig:ejemplo_solucion}, se muestra una solución óptima encontrada por el algoritmo genético.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Figures/ejemplo_solucion.eps}
    \caption{Ejemplo de una solución final generada por el algoritmo genético}
    \label{fig:ejemplo_solucion}
\end{figure}

\subsection{Resultados y análisis}

En esta sección se presentan y analizan los resultados obtenidos del experimento computacional. Los resultados se agrupan en función de las mejoras implementadas (M0, M1, M2, M3 y M4) y el tipo de instancia (5T, 10T, 20T, 30T). Se evalúan dos métricas principales: el valor aportado por las soluciones obtenidas y el tiempo de ejecución.

\subsubsection{Valor aportado por las soluciones}

Dado que los valores de las cajas en las diferentes instancias son aleatorios, no es posible comparar directamente las soluciones obtenidas. Por ello, se utiliza una métrica relativa que indica el porcentaje de mejora desde la población inicial. Se toma el mejor valor obtenido al final y se calcula el porcentaje en base al mejor valor de la población inicial, que es común para todas las estrategias de mejora.

El porcentaje de mejora se calcula por tipo de caja y mejora propuesta. Los resultados promediados sobre las 25 instancias se muestran en la Tabla \ref{tab:valor_aportado}, presentando el promedio y la desviación estándar para cada mejora.

\begin{table}[H]
    \centering
    \caption{Valor aportado por las soluciones obtenidas}
    \label{tab:valor_aportado}
    \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        \multirow{2}{*}{\textbf{Tipo de Caja}} & \multicolumn{2}{c|}{\textbf{M0}} & \multicolumn{2}{c|}{\textbf{M1}} & \multicolumn{2}{c|}{\textbf{M2}} & \multicolumn{2}{c|}{\textbf{M3}} & \multicolumn{2}{c|}{\textbf{M4}}                                                                             \\ \cline{2-11}
                                               & \textbf{media}                   & \textbf{sd}                      & \textbf{media}                   & \textbf{sd}                      & \textbf{media}                   & \textbf{sd} & \textbf{media} & \textbf{sd} & \textbf{media} & \textbf{sd} \\ \hline
        5T                                     & 9.3\%                            & 3.7                              & 10.5\%                           & 4.1                              & 10.4\%                           & 4.1         & 10.0\%         & 4.1         & 9.9\%          & 4.1         \\ \hline
        10T                                    & 18.5\%                           & 6.0                              & 20.9\%                           & 6.1                              & 20.6\%                           & 5.9         & 20.2\%         & 6.1         & 19.0\%         & 5.9         \\ \hline
        20T                                    & 27.2\%                           & 6.5                              & 33.1\%                           & 6.6                              & 32.1\%                           & 6.5         & 31.6\%         & 6.6         & 28.3\%         & 7.0         \\ \hline
        30T                                    & 29.0\%                           & 7.8                              & 37.8\%                           & 8.7                              & 37.2\%                           & 8.9         & 34.9\%         & 7.9         & 31.8\%         & 8.1         \\ \hline
        40T                                    & 29.0\%                           & 8.4                              & 44.7\%                           & 9.8                              & 43.3\%                           & 10.1        & 42.3\%         & 9.9         & 35.4\%         & 9.7         \\ \hline
        50T                                    & 35.4\%                           & 9.5                              & 56.9\%                           & 12.7                             & 54.8\%                           & 12.4        & 52.4\%         & 13.1        & 46.6\%         & 12.2        \\ \hline
    \end{tabular}
\end{table}

Como se observa en la Tabla \ref{tab:valor_aportado}, todas las mejoras propuestas (M1, M2, M3 y M4) superan a la versión sin mejoras (M0) en términos de valor aportado por las soluciones obtenidas. Las mejoras M1 y M2, que se aplican a toda la población, muestran los mejores resultados en todos los casos, aumentando la calidad de las soluciones en comparación con las demás versiones de mejora.

\subsubsection{Tiempo de ejecución}

El tiempo de ejecución es una métrica crucial para evaluar la eficiencia de los algoritmos genéticos. En este experimento, se midió el tiempo de ejecución de cada mejora y tipo de instancia, con el objetivo de evaluar el impacto de las mejoras en el rendimiento de los algoritmos.

Cada ejecución se realiza con un tipo de caja y una implementación específica (M0, M1, M2, M3 y M4). Como se estableció un límite de tiempo de 5 minutos para cada instancia, se registra el tiempo que cada evaluación tarda en encontrar su mejor solución.

En la Tabla \ref{tab:tiempo}, se muestra el tiempo promedio en encontrar la mejor solución (en segundos), junto a la desviación estándar, para cada mejora y tipo de instancia.

\begin{table}[H]
    \centering
    \caption{Tiempo promedio en encontrar la mejor solución}
    \label{tab:tiempo}
    \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        \multirow{2}{*}{\textbf{Tipo de Caja}} & \multicolumn{2}{c|}{\textbf{M0}} & \multicolumn{2}{c|}{\textbf{M1}} & \multicolumn{2}{c|}{\textbf{M2}} & \multicolumn{2}{c|}{\textbf{M3}} & \multicolumn{2}{c|}{\textbf{M4}}                                                                             \\ \cline{2-11}
                                               & \textbf{media}                   & \textbf{sd}                      & \textbf{media}                   & \textbf{sd}                      & \textbf{media}                   & \textbf{sd} & \textbf{media} & \textbf{sd} & \textbf{media} & \textbf{sd} \\ \hline
        5T                                     & 71.4                             & 72.4                             & 23.7                             & 47.6                             & 56.9                             & 71.1        & 33.6           & 63.5        & 39.3           & 47.9        \\ \hline
        10T                                    & 146.0                            & 85.3                             & 72.5                             & 69.2                             & 102.1                            & 87.9        & 61.1           & 59.8        & 117.5          & 85.8        \\ \hline
        20T                                    & 214.4                            & 56.4                             & 89.0                             & 72.6                             & 145.9                            & 62.6        & 188.0          & 79.7        & 166.8          & 70.8        \\ \hline
        30T                                    & 263.1                            & 36.3                             & 183.8                            & 73.9                             & 175.4                            & 81.9        & 186.8          & 70.4        & 231.9          & 48.9        \\ \hline
        40T                                    & 259.0                            & 39.1                             & 209.2                            & 70.9                             & 229.5                            & 65.8        & 240.2          & 44.2        & 236.5          & 63.3        \\ \hline
        50T                                    & 259.2                            & 45.7                             & 221.7                            & 54.6                             & 244.0                            & 55.2        & 250.2          & 38.9        & 248.0          & 47.8        \\ \hline
    \end{tabular}
\end{table}

La Tabla \ref{tab:tiempo} muestra que las mejoras introducidas (M1, M2, M3 y M4) reducen ligeramente el tiempo necesario para encontrar la mejor solución en comparación con M0. Esto se debe a que las mejoras permiten que el algoritmo genético converja más rápidamente. Sin embargo, también se observa una tendencia al aumento del tiempo de convergencia a medida que se incrementa el número de tipos de cajas a llenar. Esto se puede observar en la Figura \ref{fig:tiempos}.

\begin{figure}[H]
    \centering
    \includesvg[width=0.8\textwidth]{Figures/tiempos.svg}
    \caption{Tiempo promedio en encontrar la mejor solución}
    \label{fig:tiempos}
\end{figure}

La Figura \ref{fig:tiempos} destaca que la mejora M1 presenta el menor tiempo de convergencia en comparación con los otros casos, seguida de M2 y M3 en algunas situaciones. La versión sin mejoras, M0, muestra un tiempo de convergencia significativamente mayor en comparación con las versiones mejoradas. Esto indica que las mejoras propuestas permiten que el algoritmo genético converja más rápidamente.

\subsubsection{Rendimiento}

Para proporcionar una visión clara del impacto de las mejoras, se presenta un análisis comparativo del rendimiento, definido como el incremento porcentual en la calidad de las soluciones por cada unidad de tiempo. La Figura \ref{fig:rendimiento} muestra el rendimiento de las mejoras propuestas en términos de calidad de las soluciones y tiempo de ejecución.

\begin{figure}[H]
    \centering
    \includesvg[width=0.8\textwidth]{Figures/rendimiento.svg}
    \caption{Rendimiento de las mejoras propuestas}
    \label{fig:rendimiento}
\end{figure}

La Figura \ref{fig:rendimiento} muestra que la mejora M1 proporciona el mayor incremento porcentual en la calidad de las soluciones por cada unidad de tiempo, seguida de M2 y M3 en algunas situaciones. La versión sin mejoras, M0, muestra un rendimiento significativamente menor en comparación con las versiones mejoradas. Es importante resaltar que cuando se utilizan 40 tipos de cajas (40T), los rendimientos tienden a aumentar en todas las estrategias de mejora.

También podemos evaluar el rendimiento según el tiempo que toma cada método de mejora en evaluar una generación. Esto se calcula dividiendo el tiempo total de ejecución por la cantidad de generaciones realizadas, lo que proporciona una idea del tiempo que cada método de mejora necesita para evaluar cada generación. En la Figura \ref{fig:tiempo_generacion} se muestra el tiempo promedio que toma cada método de mejora en evaluar una generación.

\begin{figure}[H]
    \centering
    \includesvg[width=0.8\textwidth]{Figures/tiempo_generacion.svg}
    \caption{Tiempo promedio en evaluar una población}
    \label{fig:tiempo_generacion}
\end{figure}

La Figura \ref{fig:tiempo_generacion} muestra que las mejoras M1, M2, M3 y M4 necesitan más tiempo para evaluar una generación en comparación con la versión sin mejoras M0. Esto se debe a que las mejoras requieren tiempo adicional para realizar las operaciones de mejora en cada generación. Sin embargo, como se ha mostrado en los gráficos anteriores, las mejoras también permiten que el algoritmo genético converja más rápidamente, lo que resulta en un menor tiempo total de ejecución a pesar del tiempo adicional necesario para evaluar cada generación.

Por último, es importante resaltar que la mejora M1 es la que muestra mejor rendimiento en términos de calidad de las soluciones y tiempo de ejecución en la mayoría de evaluaciones con diferentes tipos de cajas. M2 y M3 presentan un rendimiento similar en algunas situaciones, con M2 destacando en términos de calidad de las soluciones y M3 en términos de tiempo de ejecución. M4 presenta el peor rendimiento en términos de calidad de las soluciones y tiempo de ejecución en la mayoría de evaluaciones con diferentes tipos de cajas.
